jQuery(function($){if(typeof wc_add_to_cart_params==='undefined'){return false}var AddToCartHandler=function(){$(document.body).on('click','.add_to_cart_button',this.onAddToCart).on('click','.remove_from_cart_button',this.onRemoveFromCart).on('added_to_cart',this.updateCartPage).on('added_to_cart removed_from_cart',this.updateFragments)};AddToCartHandler.prototype.onAddToCart=function(e){var $thisbutton=$(this);if($thisbutton.is('.ajax_add_to_cart')){if(!$thisbutton.attr('data-product_id')){return true}e.preventDefault();$thisbutton.removeClass('added');$thisbutton.addClass('loading');var data={};$.each($thisbutton.data(),function(key,value){data[key]=value});$(document.body).trigger('adding_to_cart',[$thisbutton,data]);$.post(wc_add_to_cart_params.wc_ajax_url.toString().replace('%%endpoint%%','add_to_cart'),data,function(response){if(!response){return}if(response.error&&response.product_url){window.location=response.product_url;return}if(wc_add_to_cart_params.cart_redirect_after_add==='yes'){window.location=wc_add_to_cart_params.cart_url;return}$(document.body).trigger('added_to_cart',[response.fragments,response.cart_hash,$thisbutton])})}};AddToCartHandler.prototype.onRemoveFromCart=function(e){var $thisbutton=$(this),$row=$thisbutton.closest('.woocommerce-mini-cart-item');e.preventDefault();$row.block({message:null,overlayCSS:{opacity:0.6}});$.post(wc_add_to_cart_params.wc_ajax_url.toString().replace('%%endpoint%%','remove_from_cart'),{cart_item_key:$thisbutton.data('cart_item_key')},function(response){if(!response||!response.fragments){window.location=$thisbutton.attr('href');return}$(document.body).trigger('removed_from_cart',[response.fragments,response.cart_hash,$thisbutton])}).fail(function(){window.location=$thisbutton.attr('href');return})};AddToCartHandler.prototype.updateCartPage=function(){var page=window.location.toString().replace('add-to-cart','added-to-cart');$.get(page,function(data){$('.shop_table.cart:eq(0)').replaceWith($(data).find('.shop_table.cart:eq(0)'));$('.cart_totals:eq(0)').replaceWith($(data).find('.cart_totals:eq(0)'));$('.cart_totals, .shop_table.cart').stop(true).css('opacity','1').unblock();$(document.body).trigger('cart_page_refreshed');$(document.body).trigger('cart_totals_refreshed')})};AddToCartHandler.prototype.updateFragments=function(e,fragments){if(fragments){$.each(fragments,function(key){$(key).addClass('updating').fadeTo('400','0.6').block({message:null,overlayCSS:{opacity:0.6}})});$.each(fragments,function(key,value){$(key).replaceWith(value);$(key).stop(true).css('opacity','1').unblock()});$(document.body).trigger('wc_fragments_loaded')}};new AddToCartHandler()});